<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NEURA BOT</title>
  <link rel="shortcut icon" href="NEURA BOT (3).png" type="image/x-icon">
   <style>
    /* Corpo */
    /* Corpo */
body {
  background-color: rgb(8, 8, 8);
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-weight: 700;
  color: white;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  overflow-x: hidden;
}

/* Navegação */
nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 15px 20px;
  background-color: transparent;
  border-bottom: 2px transparent;
}

/* Ícone de configuração */
.config {
  background: none;
  border: none;
  color: #fff;
  font-size: 28px;
  cursor: pointer;
  user-select: none;
}

/* Título */
p {
  font-size: 22px;
  font-weight: 900;
  margin: 0;
  font-family: 'Arial Black', Arial, Helvetica, sans-serif;
  color: #fff;
  letter-spacing: 2px;
}

/* Botão perfil */
.perfil1 {
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
  border-radius: 50%;
  overflow: hidden;
  width: 45px;
  height: 45px;
  box-shadow: 0 0 6px 1.5px rgba(255,255,255,0.5);
  transition: box-shadow 0.3s ease, transform 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.perfil1:hover {
  box-shadow: 0 0 10px 2px #00bfff;
  transform: scale(1.1);
}

.perfil1 img.perfil {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}

/* Container do chat */
#chat-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  max-width: 100%;
  margin: 20px auto;
  padding: 15px 20px 100px; /* espaço extra embaixo para input */
  box-sizing: border-box;
  position: relative;
  width: 100%;
  height: 100%;
}

/* Área de mensagens */
#chat-messages {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 14px;
  width: 60%;
  align-items: center;
  margin-left: auto;
  margin-right: auto;
 
}

/* Mensagens */
.message {
  background-color: #141414;
  padding: 12px 18px;
  border-radius: 18px;
  max-width: 40%;
  word-wrap: break-word;
  font-size: 15px;
  line-height: 1.4;
  
}

.user {
  align-self: flex-end;
  background-color: #fff;
  color: rgb(8, 8, 8);
  font-weight: 700;
  height: 100%;
}

.ai {
  align-self: flex-start;
  background-color: #fff;
  color: rgb(8, 8, 8);
  height: 100%;
}

.timestamp {
  font-size: 10px;
  color: #000;
  margin-top: 4px;
  text-align: right;
  font-family: 'Courier New', Courier, monospace;
  letter-spacing: 0.5px;
}

/* Campo de digitação */
.text {
  display: flex;
  align-items: center;
  gap: 10px;
  justify-content: center;
  width: 100%;
  padding: 12px 16px;
  box-sizing: border-box;
  position: fixed;
  bottom: 20px;
  left: 0;
  background-color: transparent;
  z-index: 1000;
}

.digitar {
  flex: 1;
  border-radius: 20px;
  color: white;
  padding: 12px 18px;
  background-color: transparent;
  border: 2px solid #fff;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-weight: 500;
  font-size: 16px;
  outline: none;
  max-width: 450px;
}

.digitar::placeholder {
  color: #fff;
  font-weight: 600;
}

/* Botão enviar */
.enviar {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  font-size: 26px;
  font-weight: 900;
  cursor: pointer;
  background-color: #fff;
  color: #000;
  border: none;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Sidebar */
#sidebar {
  position: fixed;
  top: 60px;
  left: 0;
  width: 200px;
  height: calc(100% - 70px);
  background: linear-gradient(135deg, #000, #000);
  color: #cce7ff;
  padding: 20px 15px;
  display: none;
  z-index: 1200;
  overflow-y: auto;
  border-right: 2px solid #000;
  box-shadow: 2px 0 15px #000;
  border-radius: 0 15px 15px 0;
  backdrop-filter: blur(8px);
  user-select: none;
}

#sidebar.active {
  display: block;
}

#sidebar h2 {
  font-weight: 900;
  font-size: 24px;
  color: #fff;
  margin-bottom: 20px;
  text-shadow: 0 0 6px #fff;
}

#sidebar ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

#sidebar li {
  margin-bottom: 16px;
  font-weight: 700;
  font-size: 16px;
  transition: color 0.3s ease;
}

#sidebar li:hover {
  color: #fff;
  cursor: pointer;
}

/* Botão menu */
.button1 {
  background-color: transparent;
  border: none;
  color: #fff;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-weight: 700;
  cursor: pointer;
  padding: 10px 20px;
  position: relative;
  border-radius: 10px;
  text-align: left;
  width: 100%;
  user-select: none;
  font-size: 16px;
}

.button1:hover {
  background-color: #000;
  color: #fff;
  box-shadow: 0 0 10px #fff;
}

.button1.active::after {
  transform: translateY(-50%) rotate(45deg);
  border-color: #fff;
}

/* Botão abrir menu */
#menuBtn {
  font-size: 34px;
  background: none;
  border: none;
  color: #fff;
  cursor: pointer;
  padding: 4px 10px;
  user-select: none;
}
.mensagem-orientacao{
  margin-left: auto;
  margin-right: auto;
}
/* RESPONSIVO para celulares */
@media (max-width: 500px) {
  #chat-container {
    margin: 10px 5px;
    padding: 10px 15px 120px;
  }

  p {
    font-size: 18px;
  }

  .config {
    font-size: 26px;
  }
#chat-messages {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 14px;
  width: 90%;
  align-items: center;
  margin-left: auto;
  margin-right: auto;
 
}
  .perfil1 {
    width: 40px;
    height: 40px;
  }

  #sidebar {
    width: 170px;
    top: 55px;
    height: calc(100% - 60px);
    padding: 15px 12px;
  }

  #sidebar h2 {
    font-size: 20px;
    margin-bottom: 16px;
  }

  .button1 {
    font-size: 14px;
    padding: 8px 16px;
  }

  .digitar {
    font-size: 14px;
    padding: 10px 14px;
  }

  .enviar {
    width: 44px;
    height: 44px;
    font-size: 22px;
  }

  .message {
    font-size: 14px;
    padding: 10px 14px;
  }

  .timestamp {
    font-size: 9px;
  }
  .mensagem-orientacao{
    margin-left: auto;
    margin-right: auto;
   
   
    margin-bottom: 100px;
  }
}
#projector {
  position: absolute; 
  top: 0px;
  left: 0px;
  width:100%;
  height:100%;
} 

.center-div {
	width:580px;
    height:374px;
    position:absolute;
    left:50%;
    top:50%;
    margin-left: -290px;
    margin-top:  -187px;
}

#preloaderDiv
{
	position:absolute;
	left:50%;
    top:50%;
    margin-left: -27px;
    margin-top:  -27px;
}

#logo{
	opacity:0;
    filter: alpha(opacity=0);
}

#date2014
{
	position:absolute;
	padding-left: 210px;
	padding-top:15px;
	opacity:0;
	top:303px;
	left:0;
    filter: alpha(opacity=0);
}html, body {
	width:100%; 
	padding:0px; 
	margin:0px;

	background: #191d1e; /* Old browsers */
	background: -moz-linear-gradient(0deg,  #191d1e 50%, #283139 100%); /* FF3.6+ */
	background: -webkit-gradient(linear, left top, right bottom, color-stop(50%,#191d1e), color-stop(100%,#283139)); /* Chrome,Safari4+ */
	background: -webkit-linear-gradient(0deg,  #191d1e 50%,#283139 100%); /* Chrome10+,Safari5.1+ */
	background: -o-linear-gradient(0deg,  #191d1e 50%,#283139 100%); /* Opera 11.10+ */
	background: -ms-linear-gradient(0deg,  #191d1e 50%,#283139 100%); /* IE10+ */
	background: linear-gradient(0deg,  #191d1e 50%,#283139 100%); /* W3C */
	filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#191d1e', endColorstr='#283139',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */
	background-attachment: absolute
}


  </style>
</head>
<body>
  <div class="stars"></div>
    <div class="shooting-star"></div>
    <div class="shooting-star"></div>
    <div class="shooting-star"></div>
    <div class="shooting-star"></div>
    <div class="shooting-star"></div>
    <div class="shooting-star"></div>
  <nav href="#comeco">
    <button class="config" id="menuBtn">&#8801;</button>
    <p>NEURA BOT</p>
    <form action="/ir-perfil">
    <button type="submit" class="perfil1">
        
      <img class="perfil" src="{{ foto }}" alt="Avatar">
      </form>
    </button>
  </nav> 
<script>
  var ParticleEngine = (function() {
	'use strict';

	function ParticleEngine(canvas_id) {
		// enforces new
		if (!(this instanceof ParticleEngine)) {
			return new ParticleEngine(args);
		}
		
		var _ParticleEngine = this;

		this.canvas_id = canvas_id;
		this.stage = new createjs.Stage(canvas_id);
		this.totalWidth = this.canvasWidth = document.getElementById(canvas_id).width = document.getElementById(canvas_id).offsetWidth;
		this.totalHeight = this.canvasHeight = document.getElementById(canvas_id).height = document.getElementById(canvas_id).offsetHeight;
		this.compositeStyle = "lighter";

		this.particleSettings = [{id:"small", num:300, fromX:0, toX:this.totalWidth, ballwidth:3, alphamax:0.4, areaHeight:.5, color:"#F0F0F0", fill:false}, 
								{id:"medium", num:100, fromX:0, toX:this.totalWidth,  ballwidth:8, alphamax:0.3, areaHeight:1, color:"#C0C0C0", fill:true}, 
								{id:"large", num:10, fromX:0, toX:this.totalWidth, ballwidth:30,  alphamax:0.2, areaHeight:1, color:"#A0A0A0", fill:true}];
		this.particleArray = [];
		this.lights = [{ellipseWidth:400, ellipseHeight:100, alpha:0.6, offsetX:0, offsetY:0, color:"#D0D0D0"}, 
						{ellipseWidth:350, ellipseHeight:250, alpha:0.3, offsetX:-50, offsetY:0, color:"#B8B8B8"}, 
						{ellipseWidth:100, ellipseHeight:80, alpha:0.2, offsetX:80, offsetY:-50, color:"#F8F8F8"}];

		this.stage.compositeOperation = _ParticleEngine.compositeStyle;


		function drawBgLight()
		{
			var light;
			var bounds;
			var blurFilter;
			for (var i = 0, len = _ParticleEngine.lights.length; i < len; i++) {				
				light = new createjs.Shape();
				light.graphics.beginFill(_ParticleEngine.lights[i].color).drawEllipse(0, 0, _ParticleEngine.lights[i].ellipseWidth, _ParticleEngine.lights[i].ellipseHeight);
				light.regX = _ParticleEngine.lights[i].ellipseWidth/2;
				light.regY = _ParticleEngine.lights[i].ellipseHeight/2; 
				light.y = light.initY = _ParticleEngine.totalHeight/2 + _ParticleEngine.lights[i].offsetY;
				light.x = light.initX =_ParticleEngine.totalWidth/2 + _ParticleEngine.lights[i].offsetX;

				blurFilter = new createjs.BlurFilter(_ParticleEngine.lights[i].ellipseWidth, _ParticleEngine.lights[i].ellipseHeight, 1);
				bounds = blurFilter.getBounds();
				light.filters = [blurFilter];
				light.cache(bounds.x-_ParticleEngine.lights[i].ellipseWidth/2, bounds.y-_ParticleEngine.lights[i].ellipseHeight/2, bounds.width*2, bounds.height*2);
				light.alpha = _ParticleEngine.lights[i].alpha;

				light.compositeOperation = "screen";
				_ParticleEngine.stage.addChildAt(light, 0);

				_ParticleEngine.lights[i].elem = light;
			}

			TweenMax.fromTo(_ParticleEngine.lights[0].elem, 10, {scaleX:1.5, x:_ParticleEngine.lights[0].elem.initX, y:_ParticleEngine.lights[0].elem.initY},{yoyo:true, repeat:-1, ease:Power1.easeInOut, scaleX:2, scaleY:0.7});
			TweenMax.fromTo(_ParticleEngine.lights[1].elem, 12, { x:_ParticleEngine.lights[1].elem.initX, y:_ParticleEngine.lights[1].elem.initY},{delay:5, yoyo:true, repeat:-1, ease:Power1.easeInOut, scaleY:2, scaleX:2, y:_ParticleEngine.totalHeight/2-50, x:_ParticleEngine.totalWidth/2+100});
			TweenMax.fromTo(_ParticleEngine.lights[2].elem, 8, { x:_ParticleEngine.lights[2].elem.initX, y:_ParticleEngine.lights[2].elem.initY},{delay:2, yoyo:true, repeat:-1, ease:Power1.easeInOut, scaleY:1.5, scaleX:1.5, y:_ParticleEngine.totalHeight/2, x:_ParticleEngine.totalWidth/2-200});
		}
		
		var blurFilter;
		function drawParticles(){

			for (var i = 0, len = _ParticleEngine.particleSettings.length; i < len; i++) {
				var ball = _ParticleEngine.particleSettings[i];

				var circle;
				for (var s = 0; s < ball.num; s++ )
				{
					circle = new createjs.Shape();
					if(ball.fill){
						circle.graphics.beginFill(ball.color).drawCircle(0, 0, ball.ballwidth);
						blurFilter = new createjs.BlurFilter(ball.ballwidth/2, ball.ballwidth/2, 1);
						circle.filters = [blurFilter];
						var bounds = blurFilter.getBounds();
						circle.cache(-50+bounds.x, -50+bounds.y, 100+bounds.width, 100+bounds.height);
					}else{
						circle.graphics.beginStroke(ball.color).setStrokeStyle(1).drawCircle(0, 0, ball.ballwidth);
					}
					
					circle.alpha = range(0, 0.1);
					circle.alphaMax = ball.alphamax;
					circle.distance = ball.ballwidth * 2;
					circle.ballwidth = ball.ballwidth;
					circle.flag = ball.id;
					_ParticleEngine.applySettings(circle, ball.fromX, ball.toX, ball.areaHeight);
					circle.speed = range(2, 10);
					circle.y = circle.initY;
					circle.x = circle.initX;
					circle.scaleX = circle.scaleY = range(0.3, 1);

					_ParticleEngine.stage.addChild(circle);
					

					animateBall(circle);

					_ParticleEngine.particleArray.push(circle);
				}
			}	
		}

		this.applySettings = function(circle, positionX, totalWidth, areaHeight)
		{
			circle.speed = range(1, 3);
			circle.initY = weightedRange(0, _ParticleEngine.totalHeight , 1, [_ParticleEngine.totalHeight * (2-areaHeight/2)/4, _ParticleEngine.totalHeight*(2+areaHeight/2)/4], 0.8 );
			circle.initX = weightedRange(positionX, totalWidth, 1, [positionX+ ((totalWidth-positionX))/4, positionX+ ((totalWidth-positionX)) * 3/4], 0.6);
		}

		function animateBall(ball)
		{
			var scale = range(0.3, 1);
			var xpos = range(ball.initX - ball.distance, ball.initX + ball.distance);
			var ypos = range(ball.initY - ball.distance, ball.initY + ball.distance);
			var speed = ball.speed;
			TweenMax.to(ball, speed, {scaleX:scale, scaleY:scale, x:xpos, y:ypos, onComplete:animateBall, onCompleteParams:[ball], ease:Cubic.easeInOut});	
			TweenMax.to(ball, speed/2, {alpha:range(0.1, ball.alphaMax), onComplete:fadeout, onCompleteParams:[ball, speed]});	
		}	

		function fadeout(ball, speed)
		{
			ball.speed = range(2, 10);
			TweenMax.to(ball, speed/2, {alpha:0 });
		}

		drawBgLight();
		drawParticles();
	}

	ParticleEngine.prototype.render = function()
	{
		this.stage.update();
	}

	ParticleEngine.prototype.resize = function()
	{
		this.totalWidth = this.canvasWidth = document.getElementById(this.canvas_id).width = document.getElementById(this.canvas_id).offsetWidth;
		this.totalHeight = this.canvasHeight = document.getElementById(this.canvas_id).height = document.getElementById(this.canvas_id).offsetHeight;
		this.render();

		for (var i= 0, length = this.particleArray.length; i < length; i++)
		{
			this.applySettings(this.particleArray[i], 0, this.totalWidth, this.particleArray[i].areaHeight);
		}

		for (var j = 0, len = this.lights.length; j < len; j++) {
			this.lights[j].elem.initY = this.totalHeight/2 + this.lights[j].offsetY;
			this.lights[j].elem.initX =this.totalWidth/2 + this.lights[j].offsetX;
			TweenMax.to(this.lights[j].elem, .5, {x:this.lights[j].elem.initX, y:this.lights[j].elem.initY});			
		}
	}

	return ParticleEngine;

}());


////////////////////////UTILS//////////////////////////////////////
//////////////////////////////////////////////////////////////////

function range(min, max)
{
	return min + (max - min) * Math.random();
}
		
function round(num, precision)
{
   var decimal = Math.pow(10, precision);
   return Math.round(decimal* num) / decimal;
}

function weightedRange(to, from, decimalPlaces, weightedRange, weightStrength)
{
	if (typeof from === "undefined" || from === null) { 
	    from = 0; 
	}
	if (typeof decimalPlaces === "undefined" || decimalPlaces === null) { 
	    decimalPlaces = 0; 
	}
	if (typeof weightedRange === "undefined" || weightedRange === null) { 
	    weightedRange = 0; 
	}
	if (typeof weightStrength === "undefined" || weightStrength === null) { 
	    weightStrength = 0; 
	}

   var ret
   if(to == from){return(to);}
 
   if(weightedRange && Math.random()<=weightStrength){
	  ret = round( Math.random()*(weightedRange[1]-weightedRange[0]) + weightedRange[0], decimalPlaces )
   }else{
	  ret = round( Math.random()*(to-from)+from, decimalPlaces )
   }
   return(ret);
}

///////////////// RUN CODE //////////////////////////
//////////////////////////////////////////////////////

var particles
(function(){
	particles = new ParticleEngine('projector');
	createjs.Ticker.addEventListener("tick", updateCanvas);
	window.addEventListener('resize', resizeCanvas, false);

	function updateCanvas(){
		particles.render();
	}

	function resizeCanvas(){
		particles.resize();
	}
}());
</script>
  <!-- Nova div sidebar -->
  <div id="sidebar">
    <h2>Menu</h2>
    <ul>
        <form action="/historico">
      <li> <button class="button1" type="submit">Historico</button></li>
      </form>
      <form action="/ir-perfil">
      <li><button class="button1" type="submit">Perfil</button></li>
      </form>
      <form action="/logout1">
      <li> <button class="button1" type="submit">Sair</button></li>
      </form>
    </ul>
  </div>

  <div id="chat-container" class="with-sidebar">
    <div id="chat-messages">
    <!-- Mensagens do chat -->
    </div>
<p class="mensagem-orientacao">Olá {{ nome_usuario }}, Como posso ajudar?</p>
    <div class="text" id="input-area">
  <input class="digitar" type="text" name="" id="user-input" placeholder="Digite uma mensagem...">
  <button id="send-btn" class="enviar">></button>
  
</div>
  </div>
  <script>
  // seu código existente aqui...

  const botaoComeco = document.getElementById('comeco');

  botaoComeco.addEventListener('click', () => {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  });
</script>
<script>

  const chatMessages = document.getElementById('chat-messages');
  const userInput = document.getElementById('user-input');
  const sendBtn = document.getElementById('send-btn');
  const sidebar = document.getElementById('sidebar');
  const menuBtn = document.getElementById('menuBtn');
  const mensagemOrientacao = document.querySelector('.mensagem-orientacao');

  // Alterna visibilidade do menu lateral
  menuBtn.addEventListener('click', () => {
    sidebar.classList.toggle('active');
  });

  // Envia mensagem quando o botão for clicado
  sendBtn.addEventListener('click', sendMessage);

  // Envia com Enter também
  userInput.addEventListener('keypress', function (e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      sendMessage();
    }
  });

  // Função para adicionar mensagem no chat
  function appendMessage(message, isUser = false, imageUrl = null) {
    const messageDiv = document.createElement('div');
    messageDiv.classList.add('message', isUser ? 'user' : 'ai');

    const content = document.createElement('div');
    content.textContent = message;
    messageDiv.appendChild(content);

    if (imageUrl) {
      const img = document.createElement('img');
      img.src = imageUrl;
      img.alt = "Imagem gerada";
      img.style.maxWidth = "100%";
      img.style.marginTop = "10px";
      img.style.borderRadius = "10px";
      messageDiv.appendChild(img);
    }

    const timestamp = document.createElement('div');
    timestamp.classList.add('timestamp');
    timestamp.textContent = new Date().toLocaleTimeString();
    messageDiv.appendChild(timestamp);

    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  // Função para enviar mensagem ao servidor
  function sendMessage() {
    const message = userInput.value.trim();
    if (!message) return;

    // Esconde mensagem de orientação (se existir)
    if (mensagemOrientacao) {
      mensagemOrientacao.style.display = "none";
    }

    appendMessage(message, true);
    userInput.value = '';

    fetch('/chat1', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message: message })
    })
    .then(response => response.json())
    .then(data => {
      const resposta = data.response || "Erro ao obter resposta.";
      const imageUrl = data.image_url || null;
      appendMessage(resposta, false, imageUrl);
    })
    .catch(error => {
      console.error('Erro:', error);
      appendMessage('Erro ao se comunicar com o servidor.', false);
    });
  }
</script>

</body>
</html>
